{
    # Keeps Caddy from trying to force HTTP users to HTTPS
    auto_https disable_redirects
}

# The Plain HTTP Block (No encryption)
http://34.150.25.115 {
    root * /srv
    
    # Reverse proxy API requests to Flask backend
    handle /api/* {
        reverse_proxy api:5000
    }
    
    # Serve static files
    handle {
        file_server
    }
}

# The Secure HTTPS Block (With self-signed encryption)
https://34.150.25.115 {
    root * /srv
    tls internal
    
    # Reverse proxy API requests to Flask backend
    handle /api/* {
        reverse_proxy api:5000
    }
    
    # Serve static files
    handle {
        file_server
    }
}
